#### 说明

 

该系统基于SQLite3数据库搭建，直接运行main.py即可

 

#### 数据库

 

该系统数据库中共有四张表，分别为：

users: 储存用户信息

​    - id：integer，主键，自增 用户ID

\- name：text 用户姓名

\- password： text 密码

\- is_admin： integer 1表示是管理员，0表示是用户

\- book_number: integer用户借书数量

books：储存图书信息

​    \- id： integer， 主键，自增 图书ID

​    \- name：text 图书名字

​    \- describe：text 图书介绍

​    \- category：text 外键 不可重复 图书类目

​    \- borrowed_num: integer已被借阅的数量

​    \- rest_num：integer剩余未被借阅的数量

Categories：储存类目信息

​    \- id: 类目ID

​    \- book_number：integer该类目下图书的数量

​    \- name: text 类目名字

Events：借书事件

\- id：integer 借书事件编号

\- event_user integer借书用户id

\- event_book integer被借的书 id

\- event_time timestamp 借书时间

 

数据库初始化时会默认在user表中插入一个Administer 管理员用户，拥有管理员权限。

初始化时默认生成一个 no Category 的类目。

 

#### 代码

整个代码分为三层

1、 数据库操作

users_operation、books_operation、categories_operation、events_operation分别封装了对数据库最直接的一些增删改查操作，并针对不同的功能增添了一些特定的函数，这一层为对代码的最直接的操作

2、 用户功能操作

guest.py和 administer.py

这部分分为管理员操作界面和普通用户操作界面

管理员操作界面实现了如下功能：

a、 增加图书，并在对应书类目中增加数量，如果新增图书的类目之前未创建过，则自动创建新的图书类目

b、 移除一定数量的图书，当总数量为0时，将该图书从数据库中移除。

c、 查询图书信息，输出图书的名字，介绍，借阅数量，库存数量，类目

d、 编辑图书信息，包括书名，介绍，类目，在修改类目时会同时维护新类目和旧类目的图书数量信息

e、 添加图书类目

f、  移除图书类目，同时该类目下的图书新类目均被修改为No Category

g、 查询类目信息，并输出类目下所有图书的相关信息

h、 增加新用户

i、  移除用户，并将其借阅的图书进行归还，删除对应的所有订单信息。

j、  查询用户信息，并将其输出，同时输出该用户所有借书的订单信息

k、 修改用户信息，包括姓名，密码，其中修改密码需要两次输入确认

用户界面实现：

a、 借阅图书，增加图书的借阅量，减少图书的库存量，并生成新的订单储存该借书事件。且限制每人对每本图书最多可借阅一次。

b、 归还图书，删除对应订单信息，将图书库存量加一，借阅量减一。

c、 查询图书信息，包括书名，介绍，类目

d、 修改自己用户的信息，包括姓名和密码，其中修改密码时需要输入旧密码确认，然后输入两次新密码确认。

整个过程对非法返回均有判断，来保证代码的健壮性。

3、 登陆界面

main.py

通过用户ID与密码进行登录，并获取其是否有管理员权限，如果拥有则进入管理员操作界面，否则进入用户操作界面并将当前登录用户ID作为参数传入来保证所有的操作都是针对当前登录用户进行的。